<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Debian用Nginx搭建Webdav server | 晴天</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Debian用Nginx搭建Webdav server</h1><a id="logo" href="/."><img class="nofancybox" src="/images/qingtian.svg" width="85"></a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Debian用Nginx搭建Webdav server</h1><div class="post-meta">Oct 25, 2016<span> | </span><span class="category"><a href="/categories/Linux/">Linux</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#需求"><span class="toc-number">1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#要求"><span class="toc-number">2.</span> <span class="toc-text">要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#步骤"><span class="toc-number">3.</span> <span class="toc-text">步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装nginx并配置"><span class="toc-number">3.1.</span> <span class="toc-text">安装nginx并配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#配置防火墙"><span class="toc-number">3.2.</span> <span class="toc-text">配置防火墙</span></a></li></ol></li></ol></div></div><div class="post-content"><h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>坑爹的115现在登陆还要用手机号验证，然而博主之前的手机号早就不用了，换手机号必须人工申诉，竟然要身份证信息，果断放弃了，还有半年的VIP也浪费了。然后呢，问题来了，学校的烂网连国内尤其慢，而且本来带宽就不高，之前用115配合kodi在线看，速度还可以接受，没了115用城通，慢的不行，某度更是垃圾，对于博主这种没事就找个电影看看的人实在没法忍，于是突然想到可以利用VPS进行中转，先把电影下到VPS上，然后在线看，就不卡了。怎么在线看呢？用webdav.</p>
<h3 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h3><ol>
<li>Nginx full或者Nginx + nginx-extras</li>
<li>htpasswd，用来做用户名+密码验证</li>
</ol>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><h4 id="安装nginx并配置"><a href="#安装nginx并配置" class="headerlink" title="安装nginx并配置"></a>安装nginx并配置</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aptitude install nginx nginx-extras</span><br><span class="line">mkdir -p <span class="regexp">/var/</span>www<span class="regexp">/webdav/</span>files <span class="comment"># Webdav根目录</span></span><br></pre></td></tr></table></figure>
<p>创建<code>/etc/nginx/conf.d/webdav.conf</code>，并添加<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">8080</span>; <span class="comment"># 端口</span></span><br><span class="line">    <span class="attribute">server_name</span>  webdav.Your_domain; <span class="comment">#域名</span></span><br><span class="line">    <span class="attribute">root</span> /var/www/webdav/files; <span class="comment"># 根目录</span></span><br><span class="line">    <span class="attribute">client_body_temp_path</span> /var/www/webdav/tmp;</span><br><span class="line">    <span class="attribute">access_log</span>  /var/log/nginx/webdav_access.log;</span><br><span class="line">    <span class="attribute">error_log</span>   /var/log/nginx/webdav_error.log;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">      <span class="attribute">auth_basic</span> <span class="string">"Not currently available"</span>;</span><br><span class="line">      <span class="attribute">auth_basic_user_file</span> /etc/nginx/conf.d/.htpasswd; <span class="comment"># htpasswd验证文件</span></span><br><span class="line"></span><br><span class="line">      <span class="attribute">dav_methods</span> PUT DELETE MKCOL COPY MOVE;</span><br><span class="line">      <span class="attribute">dav_ext_methods</span> PROPFIND OPTIONS;</span><br><span class="line"></span><br><span class="line">      <span class="attribute">create_full_put_path</span> <span class="literal">on</span>;</span><br><span class="line">      <span class="attribute">dav_access</span> user:rw group:r;</span><br><span class="line"></span><br><span class="line">      <span class="attribute">autoindex</span> <span class="literal">on</span>; <span class="comment"># 可以在浏览器打开</span></span><br><span class="line"></span><br><span class="line">      <span class="attribute">limit_except</span> GET &#123;</span><br><span class="line">        <span class="attribute">allow</span> <span class="number">115.115.0.0</span>/<span class="number">32</span>; <span class="comment"># 允许访问的IP段，可以填自己家的IP，这样就只有你家的IP可以访问，大大增加安全性。</span></span><br><span class="line">        <span class="attribute">deny</span>  all;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建<code>.htpasswd</code>，这是简单密码验证，因为限制了IP，所以安全性足够了。<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htpasswd -c <span class="regexp">/etc/</span>nginx<span class="regexp">/conf.d/</span>.htpasswd UserName <span class="comment">#自己用户名，然后输入密码</span></span><br></pre></td></tr></table></figure></p>
<h4 id="配置防火墙"><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a>配置防火墙</h4><p>如果你的防火墙默认放过所有包，可以忽略此步骤。<br><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -m tcp --dport <span class="number">8080</span> -m <span class="keyword">state</span> --state NEW -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<p>如果想重启后防火墙依然生效，请看<a href="https://www.thomas-krenn.com/en/wiki/Saving_Iptables_Firewall_Rules_Permanently" target="_blank" rel="noopener">这里</a>。<br>然后<code>service nginx restart</code>应该可以跑起来了。在浏览器输入<code>http://webdav.Your_domain:8080</code>如果要求登陆就说明成了，只需要将文件放在你设置的webdav根目录就可以访问，也可以用支持webdav的客户端访问。</p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>shengdie</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2016/10/25/webdave-nginx/">http://shengdie.github.io/2016/10/25/webdave-nginx/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</li></ul></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="http://shengdie.github.io/2016/10/25/webdave-nginx/" data-id="ckoxxnpjw001myfmra8wjvmq6" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKklEQVR42u3ay27DMAxE0fz/T7vbAIGpGVIqIPJqVSSNpeMFIT4+H3k9X+v7k/jb38+VZ779/4YFAwaMaxlPuOIN4l+9gd/OEL+gxauBAQPGAIb+6JjhIuPnKGeDAQMGDOUiqF/1lOPCgAEDxmmGG0zrV0kYMGDMYShJrFJ6UwpnSpp6MBeHAQPGhQy96v7/fx/pb8CAAeMqxmMu91f6sZ7CggEDRm/G3m3cgYlKwIUBA8ZMxon0NT5QJRk2cnEYMGBczjAuXuE2ekjVw7TxQmHAgDGA4QZBHeY+X79iwoABYxojN/SQ3NK8FEqjGzBgwGjNyBXUTgdcFwwDBozeDL2sX0l064Nii9cEAwaMAYxcozF3BdT3ikmLXBwGDBjtGG6ZXi+Z5ZoEduCGAQPGAEbuSqe3JHNtTr1RCgMGjN4MPYHUq3du4HbPYIRdGDBgtGDoSakbWN0GQ2nUAwYMGK0ZymCWe9XTC3C5AY7XJ8CAAWMAY1cieiLHtEcuYMCA0ZThHq6yfT25XVwNYcCAMYbhFuvdhHZDkHXfOgwYMC5nuGlqruWZGzhLJrEwYMBowXjM5QZct/GQDLgwYMBozdBXrgG5NxArbQMYMGB0ZehDFfUhiXogtpNYGDBgNGIopf8KaW8SCwMGDBj6tSw+Sr1sZ99eYcCAAaNQ4teLcW5pDwYMGHMY7kjEoi8qfOumwdvKbTBgwLiQUUodUwWySguh1NSEAQPGfYw/owOJhx/R4ikAAAAASUVORK5CYII=">分享</a><div class="tags"><a href="/tags/VPS/">VPS</a></div><div class="post-nav"><a class="pre" href="/2016/10/27/nginx-htts2/">Nginx启用HTTPS和HTTP/2</a><a class="next" href="/2016/10/22/quantum-field-lecnote/">推荐关于物理的学习资源</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://shengdie.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Physics/">Physics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TePUB/">TePUB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/boosayy/">书声</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/websites/">网站</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/dao/">道</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/boosayy/" style="font-size: 15px;">书声</a> <a href="/tags/Emacs/" style="font-size: 15px;">Emacs</a> <a href="/tags/Latex/" style="font-size: 15px;">Latex</a> <a href="/tags/TePUB/" style="font-size: 15px;">TePUB</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/ShellCommands/" style="font-size: 15px;">ShellCommands</a> <a href="/tags/QuantumField/" style="font-size: 15px;">QuantumField</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/05/21/virtual_coin/">关于虚拟币的思考</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/03/shuimian-dao/">【转】利用睡眠修习禅定</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/29/vnc-linux/">Linux设置VNC服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/25/libai/">如果没有李白</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/09/abaqus-singularity/">Manjaro借助singularity安裝abaqus 2018</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/25/TePUB-Help/">TePUB使用教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/08/Win-Emacs-lag/">解决Windows下Emacs Unicode字符爆卡的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/29/Mac-Emacs-Skim/">Mac下配置Emacs+AucTex+Skim</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/08/googleBBR/">BBR阻塞算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/20/Boosayy-help/">书声使用帮助</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">晴天.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>